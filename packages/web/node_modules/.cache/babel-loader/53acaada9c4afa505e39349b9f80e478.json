{"ast":null,"code":"import _regeneratorRuntime from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport MessageEnum, { getName } from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\nimport { isEmpty } from 'lodash';\nimport * as Yup from \"yup\"; // Customizable Area Start\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\nexport default class EmailAccountLoginController extends BlockComponent {\n  // Customizable Area Start\n  // Customizable Area End\n  constructor(props) {\n    super(props);\n    this.apiEmailLoginCallId = \"\";\n    this.validationApiCallId = \"\";\n    this.apiPasswordCallId = \"\";\n    this.apiForgotCallId = \"\";\n    this.emailReg = void 0;\n    this.labelTitle = \"\";\n\n    this.getToken = () => {\n      const msg = new Message(getName(MessageEnum.SessionRequestMessage));\n      this.send(msg);\n      console.log('msg', msg);\n    };\n\n    this.txtInputPasswordWebProps = {\n      onChange: text => {\n        this.setState({\n          errorPassword: '',\n          password: text === null || text === void 0 ? void 0 : text.target.value\n        });\n      }\n    };\n    this.txtInputConfirmPasswordWebProps = {\n      onChange: text => {\n        this.setState({\n          errorConfirmPassword: '',\n          confirmPassword: text === null || text === void 0 ? void 0 : text.target.value\n        });\n      }\n    };\n    this.txtInputEmailWebProps = {\n      onChange: text => {\n        this.setState({\n          errorEmail: '',\n          email: text === null || text === void 0 ? void 0 : text.target.value\n        }); //@ts-ignore\n\n        this.txtInputEmailProps.value = text === null || text === void 0 ? void 0 : text.target.value;\n      }\n    };\n    this.txtInputEmailMobileProps = _objectSpread(_objectSpread({}, this.txtInputEmailWebProps), {}, {\n      autoCompleteType: \"email\",\n      keyboardType: \"email-address\"\n    });\n    this.txtInputEmailProps = this.isPlatformWeb() ? this.txtInputEmailWebProps : this.txtInputEmailMobileProps;\n\n    this.handleForgotPassword = values => {\n      // if (\n      //   this.state.email === null ||\n      //   this.state.email.length === 0 ||\n      //   !this.emailReg.test(this.state.email)\n      // ) {\n      //   this.setState({\n      //       errorEmail :configJSON.pleaseEnterAValidEmail\n      //   })  \n      //   return false;\n      // }\n      const header = {\n        \"Content-Type\": configJSON.forgotPasswordAPiContentType\n      }; // console.log('this.state',this.state)\n\n      const attrs = {\n        email: values.email\n      };\n      const data = {\n        type: \"email_account\",\n        attributes: attrs\n      };\n      const httpBody = {\n        data: data\n      };\n      console.log('httpBody', httpBody);\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage)); // console.log(\"requestMessage\", requestMessage);\n\n      this.apiForgotCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.ForgotPasswordApiEndPoint);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(header));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(httpBody));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n      return true;\n    };\n\n    this.openSnackBarHandler = (type, message) => {\n      console.log(\"type,message\", type, message);\n      this.setState({\n        snackBar: {\n          show: true,\n          message: message,\n          type\n        }\n      });\n    };\n\n    this.closeSnackBarHandler = () => {\n      this.setState({\n        snackBar: {\n          show: false,\n          message: this.state.snackBar.message,\n          type: this.state.snackBar.type\n        }\n      });\n    };\n\n    this.receive = this.receive.bind(this); // Customizable Area Start\n\n    this.subScribedMessages = [getName(MessageEnum.CountryCodeMessage), getName(MessageEnum.RestAPIResponceMessage), getName(MessageEnum.ReciveUserCredentials)];\n    let EmailOnlySchema = {\n      email: Yup.string().email(configJSON.errorEmailNotValid).required(configJSON.errorEmailRequired)\n    };\n    let NewPasswordSchema = {\n      password: Yup.string().matches(configJSON.PASSWORD_REGULAR_EXPRESSION, configJSON.errorNewPasswordNotValid).required(configJSON.errorNewPasswordEmpty),\n      passwordConfirmation: Yup.string().oneOf([Yup.ref('password'), null], 'Passwords must match').required(configJSON.errorNewPasswordEmpty)\n    };\n    this.state = {\n      email: '',\n      errorEmail: '',\n      password: \"\",\n      errorPassword: \"\",\n      confirmPassword: '',\n      errorConfirmPassword: '',\n      EmailOnlySchema: EmailOnlySchema,\n      NewPasswordSchema: NewPasswordSchema,\n      snackBar: {\n        show: false\n      }\n    };\n    this.emailReg = new RegExp(\"\"); // Customizable Area End\n\n    runEngine.attachBuildingBlock(this, this.subScribedMessages);\n  }\n\n  componentDidMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            // this.callGetValidationApi();\n            _this.send(new Message(getName(MessageEnum.RequestUserCredentials))); // Customizable Area Start\n            // Customizable Area End\n\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  }\n\n  receive(from, message) {\n    var _this2 = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var responseJson, errorReponse, apiRequestCallId, errors, _this2$props;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            // Customizable Area Start\n            if (getName(MessageEnum.RestAPIResponceMessage) === message.id) {\n              responseJson = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n              errorReponse = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n              apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n\n              if (responseJson && !responseJson.errors) {\n                if (apiRequestCallId != null) {\n                  console.log(\"responseJson\", responseJson); // \n\n                  if (apiRequestCallId === _this2.apiPasswordCallId && responseJson !== undefined) {\n                    _this2.openSnackBarHandler('success', configJSON.successCreateAccount);\n\n                    setTimeout(() => {\n                      //@ts-ignore\n                      localStorage.setItem(\"user_type\", responseJson.data.user_type); //@ts-ignore\n\n                      _this2.props.history.push(\"/\");\n                    }, 1000);\n                  }\n\n                  if (apiRequestCallId === _this2.apiForgotCallId && responseJson !== undefined) {\n                    _this2.openSnackBarHandler('success', configJSON.successCreateAccount);\n\n                    setTimeout(() => {\n                      localStorage.setItem(\"email\", _this2.state.email);\n                      localStorage.setItem(\"user_type\", responseJson.data.user_type); // @ts-ignore\n\n                      _this2.props.history.push(\"new-password\");\n                    }, 1000);\n                  }\n                }\n              } else {\n                errors = responseJson.errors;\n\n                _this2.parseApiCatchErrorResponse(errorReponse);\n\n                if (errors[0].token === 'Invalid token' || errors[0].token === 'Token has Expired') {\n                  localStorage.setItem(\"auth\", \"\"); //@ts-ignore\n\n                  (_this2$props = _this2.props) === null || _this2$props === void 0 ? void 0 : _this2$props.history.push(\"/login\");\n                } else if (errors[0].message) {\n                  _this2.openSnackBarHandler('error', errors[0].message);\n                } else if (errors[0].otp) {\n                  _this2.openSnackBarHandler('error', errors[0].otp);\n                }\n              }\n            } // Customizable Area End\n\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }))();\n  } //apiForgotCallId\n\n\n  sendLoginFailMessage() {\n    const msg = new Message(getName(MessageEnum.LoginFaliureMessage));\n    this.send(msg);\n  } //   sendLoginSuccessMessage() {\n  //     const msg: Message = new Message(getName(MessageEnum.LoginSuccessMessage));\n  //     msg.addData(getName(MessageEnum.LoginUserName), this.state.email);\n  //     msg.addData(getName(MessageEnum.CountyCodeDataMessage), null);\n  //     msg.addData(getName(MessageEnum.LoginPassword), this.state.password);\n  //     msg.addData(\n  //       getName(MessageEnum.LoginIsRememberMe),\n  //       this.state.checkedRememberMe\n  //     );\n  //     this.send(msg);\n  //   }\n\n\n  saveLoggedInUserData(responseJson) {\n    console.log('responseJsonresponseJson', responseJson);\n\n    if (responseJson && responseJson.meta && responseJson.meta.token) {\n      const msg = new Message(getName(MessageEnum.SessionSaveMessage));\n      msg.addData(getName(MessageEnum.SessionResponseData), JSON.stringify(responseJson));\n      msg.addData(getName(MessageEnum.SessionResponseToken), responseJson.meta.token);\n      localStorage.setItem('auth', responseJson.meta.token);\n      this.send(msg);\n    }\n  }\n\n  openInfoPage() {\n    // const msg: Message = new Message(getName(MessageEnum.AccoutLoginSuccess));\n    // console.log('msg',msg)\n    // console.log('this.props',this.props)\n    // msg.addData(getName(MessageEnum.NavigationPropsMessage), this.props);\n    // this.send(msg);\n    // localStorage.setItem('auth',);\n    // alert('Login Successful')\n    //@ts-ignore\n    this.props.history.push(\"/\"); // this.props.history.push(\"select-domain\")\n  }\n\n  goToForgotPassword() {\n    const msg = new Message(getName(MessageEnum.NavigationForgotPasswordMessage));\n    msg.addData(getName(MessageEnum.NavigationPropsMessage), this.props);\n    msg.addData(getName(MessageEnum.NavigationForgotPasswordPageInfo), \"email\");\n    this.send(msg);\n  }\n\n  goToSocialLogin() {\n    const msg = new Message(getName(MessageEnum.NavigationSocialLogInMessage));\n    msg.addData(getName(MessageEnum.NavigationPropsMessage), this.props);\n    this.send(msg);\n  }\n\n  createNewPassword() {\n    // console.log(\"API HIT\");\n    // console.log('this.state',this.state)\n    if (isEmpty(this.state.password)) {\n      this.setState({\n        errorPassword: configJSON.errorPasswordEmpty\n      });\n      return false;\n    } else if (this.state.password.length > 10) {\n      this.setState({\n        errorPassword: configJSON.errorPasswordLengthMax\n      });\n      return false;\n    } else if (this.state.password.length < 8) {\n      this.setState({\n        errorPassword: configJSON.errorPasswordLengthLess\n      });\n      return false;\n    }\n\n    if (isEmpty(this.state.confirmPassword)) {\n      this.setState({\n        errorConfirmPassword: configJSON.errorPasswordEmpty\n      });\n      return false;\n    } else if (this.state.password !== this.state.confirmPassword) {\n      this.setState({\n        errorConfirmPassword: configJSON.errorConfirmPasswordNotMatch\n      });\n      return false;\n    }\n\n    const header = {\n      \"Content-Type\": configJSON.forgotPasswordAPiContentType\n    };\n    console.log('this.state', this.state);\n    const attrs = {\n      password: this.state.password,\n      confirm_password: this.state.confirmPassword,\n      email: this.state.email || localStorage.getItem('email') || ''\n    };\n    const data = {\n      type: \"email_account\",\n      attributes: attrs\n    };\n    const httpBody = {\n      data: data\n    };\n    console.log('httpBody', httpBody);\n    const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage)); // console.log(\"requestMessage\", requestMessage);\n\n    this.apiPasswordCallId = requestMessage.messageId;\n    requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.newPasswordApiEndPoint);\n    requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(header));\n    requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(httpBody));\n    requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n    return true;\n  }\n\n  callGetValidationApi() {\n    const headers = {\n      \"Content-Type\": configJSON.validationApiContentType\n    };\n    const getValidationsMsg = new Message(getName(MessageEnum.RestAPIRequestMessage));\n    this.validationApiCallId = getValidationsMsg.messageId;\n    getValidationsMsg.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.urlGetValidations);\n    getValidationsMsg.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n    getValidationsMsg.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.validationApiMethodType);\n    runEngine.sendMessage(getValidationsMsg.id, getValidationsMsg);\n  }\n\n}","map":{"version":3,"sources":["/home/lp-greenapex/gargi/okydpim-36944-react-native/src/packages/blocks/forgot-password/src/NewPasswordController.web.tsx"],"names":["Message","BlockComponent","MessageEnum","getName","runEngine","isEmpty","Yup","configJSON","require","EmailAccountLoginController","constructor","props","apiEmailLoginCallId","validationApiCallId","apiPasswordCallId","apiForgotCallId","emailReg","labelTitle","getToken","msg","SessionRequestMessage","send","console","log","txtInputPasswordWebProps","onChange","text","setState","errorPassword","password","target","value","txtInputConfirmPasswordWebProps","errorConfirmPassword","confirmPassword","txtInputEmailWebProps","errorEmail","email","txtInputEmailProps","txtInputEmailMobileProps","autoCompleteType","keyboardType","isPlatformWeb","handleForgotPassword","values","header","forgotPasswordAPiContentType","attrs","data","type","attributes","httpBody","requestMessage","RestAPIRequestMessage","messageId","addData","RestAPIResponceEndPointMessage","ForgotPasswordApiEndPoint","RestAPIRequestHeaderMessage","JSON","stringify","RestAPIRequestBodyMessage","RestAPIRequestMethodMessage","httpPostMethod","sendMessage","id","openSnackBarHandler","message","snackBar","show","closeSnackBarHandler","state","receive","bind","subScribedMessages","CountryCodeMessage","RestAPIResponceMessage","ReciveUserCredentials","EmailOnlySchema","string","errorEmailNotValid","required","errorEmailRequired","NewPasswordSchema","matches","PASSWORD_REGULAR_EXPRESSION","errorNewPasswordNotValid","errorNewPasswordEmpty","passwordConfirmation","oneOf","ref","RegExp","attachBuildingBlock","componentDidMount","RequestUserCredentials","from","responseJson","getData","RestAPIResponceSuccessMessage","errorReponse","RestAPIResponceErrorMessage","apiRequestCallId","RestAPIResponceDataMessage","errors","undefined","successCreateAccount","setTimeout","localStorage","setItem","user_type","history","push","parseApiCatchErrorResponse","token","otp","sendLoginFailMessage","LoginFaliureMessage","saveLoggedInUserData","meta","SessionSaveMessage","SessionResponseData","SessionResponseToken","openInfoPage","goToForgotPassword","NavigationForgotPasswordMessage","NavigationPropsMessage","NavigationForgotPasswordPageInfo","goToSocialLogin","NavigationSocialLogInMessage","createNewPassword","errorPasswordEmpty","length","errorPasswordLengthMax","errorPasswordLengthLess","errorConfirmPasswordNotMatch","confirm_password","getItem","newPasswordApiEndPoint","callGetValidationApi","headers","validationApiContentType","getValidationsMsg","urlGetValidations","validationApiMethodType"],"mappings":";;;AACA,SAASA,OAAT,QAAwB,gCAAxB;AACA,SAASC,cAAT,QAA+B,uCAA/B;AACA,OAAOC,WAAP,IACEC,OADF,QAEO,6CAFP;AAGA,SAASC,SAAT,QAA0B,kCAA1B;AACA,SAAkBC,OAAlB,QAAgC,QAAhC;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB,C,CAEA;AACA;;AAEA,OAAO,MAAMC,UAAU,GAAGC,OAAO,CAAC,UAAD,CAA1B;AAiCP,eAAe,MAAMC,2BAAN,SAA0CR,cAA1C,CAIb;AACA;AAQA;AAEAS,EAAAA,WAAW,CAACC,KAAD,EAAe;AACxB,UAAMA,KAAN;AADwB,SAT1BC,mBAS0B,GATI,EASJ;AAAA,SAR1BC,mBAQ0B,GARI,EAQJ;AAAA,SAP1BC,iBAO0B,GAPE,EAOF;AAAA,SAN1BC,eAM0B,GANA,EAMA;AAAA,SAJ1BC,QAI0B;AAAA,SAH1BC,UAG0B,GAHL,EAGK;;AAAA,SAyD1BC,QAzD0B,GAyDf,MAAM;AACf,YAAMC,GAAY,GAAG,IAAInB,OAAJ,CACnBG,OAAO,CAACD,WAAW,CAACkB,qBAAb,CADY,CAArB;AAGA,WAAKC,IAAL,CAAUF,GAAV;AACDG,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBJ,GAAlB;AAEA,KAhEyB;;AAAA,SAoE1BK,wBApE0B,GAoEC;AACzBC,MAAAA,QAAQ,EAAGC,IAAD,IAAe;AACvB,aAAKC,QAAL,CAAc;AAAEC,UAAAA,aAAa,EAAC,EAAhB;AAAqBC,UAAAA,QAAQ,EAAEH,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEI,MAAN,CAAaC;AAA5C,SAAd;AACD;AAHwB,KApED;AAAA,SA0E1BC,+BA1E0B,GA0EQ;AAChCP,MAAAA,QAAQ,EAAGC,IAAD,IAAe;AACvB,aAAKC,QAAL,CAAc;AAAEM,UAAAA,oBAAoB,EAAC,EAAvB;AAA4BC,UAAAA,eAAe,EAAER,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEI,MAAN,CAAaC;AAA1D,SAAd;AACD;AAH+B,KA1ER;AAAA,SAiF1BI,qBAjF0B,GAiFF;AACtBV,MAAAA,QAAQ,EAAGC,IAAD,IAAe;AACvB,aAAKC,QAAL,CAAc;AAAES,UAAAA,UAAU,EAAC,EAAb;AAAkBC,UAAAA,KAAK,EAAEX,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEI,MAAN,CAAaC;AAAtC,SAAd,EADuB,CAEvB;;AACA,aAAKO,kBAAL,CAAwBP,KAAxB,GAAgCL,IAAhC,aAAgCA,IAAhC,uBAAgCA,IAAI,CAAEI,MAAN,CAAaC,KAA7C;AACD;AALqB,KAjFE;AAAA,SAyF1BQ,wBAzF0B,mCA0FrB,KAAKJ,qBA1FgB;AA2FxBK,MAAAA,gBAAgB,EAAE,OA3FM;AA4FxBC,MAAAA,YAAY,EAAE;AA5FU;AAAA,SA+F1BH,kBA/F0B,GA+FL,KAAKI,aAAL,KACjB,KAAKP,qBADY,GAEjB,KAAKI,wBAjGiB;;AAAA,SAwV1BI,oBAxV0B,GAwVHC,MAAD,IAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEF,YAAMC,MAAM,GAAG;AACb,wBAAgBtC,UAAU,CAACuC;AADd,OAAf,CAZ6C,CAgB7C;;AACA,YAAMC,KAAK,GAAG;AACZV,QAAAA,KAAK,EAAEO,MAAM,CAACP;AADF,OAAd;AAIA,YAAMW,IAAI,GAAG;AACXC,QAAAA,IAAI,EAAE,eADK;AAEXC,QAAAA,UAAU,EAAEH;AAFD,OAAb;AAKA,YAAMI,QAAQ,GAAG;AACfH,QAAAA,IAAI,EAAEA;AADS,OAAjB;AAIA1B,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuB4B,QAAvB;AAEA,YAAMC,cAAc,GAAG,IAAIpD,OAAJ,CACrBG,OAAO,CAACD,WAAW,CAACmD,qBAAb,CADc,CAAvB,CAhC6C,CAoC7C;;AACA,WAAKtC,eAAL,GAAuBqC,cAAc,CAACE,SAAtC;AACAF,MAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAACsD,8BAAb,CADT,EAEEjD,UAAU,CAACkD,yBAFb;AAKAL,MAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAACwD,2BAAb,CADT,EAEEC,IAAI,CAACC,SAAL,CAAef,MAAf,CAFF;AAKAO,MAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAAC2D,yBAAb,CADT,EAEEF,IAAI,CAACC,SAAL,CAAeT,QAAf,CAFF;AAKAC,MAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAAC4D,2BAAb,CADT,EAEEvD,UAAU,CAACwD,cAFb;AAMA3D,MAAAA,SAAS,CAAC4D,WAAV,CAAsBZ,cAAc,CAACa,EAArC,EAAyCb,cAAzC;AAEE,aAAO,IAAP;AACH,KAtZyB;;AAAA,SAyZ1Bc,mBAzZ0B,GAyZJ,CAACjB,IAAD,EAA8DkB,OAA9D,KAAwF;AAC5G7C,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2B0B,IAA3B,EAAgCkB,OAAhC;AACA,WAAKxC,QAAL,CAAc;AAAEyC,QAAAA,QAAQ,EAAE;AACxBC,UAAAA,IAAI,EAAE,IADkB;AAExBF,UAAAA,OAAO,EAAEA,OAFe;AAGxBlB,UAAAA;AAHwB;AAAZ,OAAd;AAKD,KAhayB;;AAAA,SAma1BqB,oBAna0B,GAmaH,MAAM;AAC3B,WAAK3C,QAAL,CAAc;AAAEyC,QAAAA,QAAQ,EAAE;AACxBC,UAAAA,IAAI,EAAE,KADkB;AAExBF,UAAAA,OAAO,EAAE,KAAKI,KAAL,CAAWH,QAAX,CAAoBD,OAFL;AAGxBlB,UAAAA,IAAI,EAAE,KAAKsB,KAAL,CAAWH,QAAX,CAAoBnB;AAHF;AAAZ,OAAd;AAKD,KAzayB;;AAExB,SAAKuB,OAAL,GAAe,KAAKA,OAAL,CAAaC,IAAb,CAAkB,IAAlB,CAAf,CAFwB,CAIxB;;AACA,SAAKC,kBAAL,GAA0B,CACxBvE,OAAO,CAACD,WAAW,CAACyE,kBAAb,CADiB,EAExBxE,OAAO,CAACD,WAAW,CAAC0E,sBAAb,CAFiB,EAGxBzE,OAAO,CAACD,WAAW,CAAC2E,qBAAb,CAHiB,CAA1B;AAMA,QAAIC,eAAe,GAAE;AACnBzC,MAAAA,KAAK,EAAE/B,GAAG,CAACyE,MAAJ,GACJ1C,KADI,CACE9B,UAAU,CAACyE,kBADb,EAEJC,QAFI,CAEK1E,UAAU,CAAC2E,kBAFhB;AADY,KAArB;AAMC,QAAIC,iBAAiB,GAAG;AACvBtD,MAAAA,QAAQ,EAAEvB,GAAG,CAACyE,MAAJ,GACTK,OADS,CAER7E,UAAU,CAAC8E,2BAFH,EAGR9E,UAAU,CAAC+E,wBAHH,EAKTL,QALS,CAKA1E,UAAU,CAACgF,qBALX,CADa;AAOvBC,MAAAA,oBAAoB,EAAElF,GAAG,CAACyE,MAAJ,GACnBU,KADmB,CACb,CAACnF,GAAG,CAACoF,GAAJ,CAAQ,UAAR,CAAD,EAAsB,IAAtB,CADa,EACgB,sBADhB,EAEnBT,QAFmB,CAEV1E,UAAU,CAACgF,qBAFD;AAPC,KAAxB;AAaD,SAAKhB,KAAL,GAAa;AACXlC,MAAAA,KAAK,EAAE,EADI;AAEXD,MAAAA,UAAU,EAAC,EAFA;AAGXP,MAAAA,QAAQ,EAAE,EAHC;AAIXD,MAAAA,aAAa,EAAE,EAJJ;AAKXM,MAAAA,eAAe,EAAC,EALL;AAMXD,MAAAA,oBAAoB,EAAC,EANV;AAOX6C,MAAAA,eAAe,EAACA,eAPL;AAQXK,MAAAA,iBAAiB,EAACA,iBARP;AASXf,MAAAA,QAAQ,EAAE;AACRC,QAAAA,IAAI,EAAE;AADE;AATC,KAAb;AAcA,SAAKrD,QAAL,GAAgB,IAAI2E,MAAJ,CAAW,EAAX,CAAhB,CA5CwB,CA6CxB;;AAEAvF,IAAAA,SAAS,CAACwF,mBAAV,CAA8B,IAA9B,EAA8C,KAAKlB,kBAAnD;AACD;;AAEKmB,EAAAA,iBAAN,GAA0B;AAAA;;AAAA;AAAA;AAAA;AAAA;AACxB;AACA,YAAA,KAAI,CAACxE,IAAL,CAAU,IAAIrB,OAAJ,CAAYG,OAAO,CAACD,WAAW,CAAC4F,sBAAb,CAAnB,CAAV,EAFwB,CAGxB;AAEA;;;AALwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAMzB;;AA8CKtB,EAAAA,OAAN,CAAcuB,IAAd,EAA4B5B,OAA5B,EAA8C;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAC3C;AAED,gBAAIhE,OAAO,CAACD,WAAW,CAAC0E,sBAAb,CAAP,KAAgDT,OAAO,CAACF,EAA5D,EAAgE;AAC1D+B,cAAAA,YAD0D,GAC3C7B,OAAO,CAAC8B,OAAR,CACjB9F,OAAO,CAACD,WAAW,CAACgG,6BAAb,CADU,CAD2C;AAI1DC,cAAAA,YAJ0D,GAI3ChC,OAAO,CAAC8B,OAAR,CACjB9F,OAAO,CAACD,WAAW,CAACkG,2BAAb,CADU,CAJ2C;AAOxDC,cAAAA,gBAPwD,GAOrClC,OAAO,CAAC8B,OAAR,CACvB9F,OAAO,CAACD,WAAW,CAACoG,0BAAb,CADgB,CAPqC;;AAU9D,kBAAIN,YAAY,IAAI,CAACA,YAAY,CAACO,MAAlC,EAA0C;AACxC,oBAAIF,gBAAgB,IAAI,IAAxB,EAA8B;AAC7B/E,kBAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2ByE,YAA3B,EAD6B,CAE5B;;AACA,sBAAIK,gBAAgB,KAAK,MAAI,CAACvF,iBAA1B,IAA+CkF,YAAY,KAAKQ,SAApE,EAA+E;AAC7E,oBAAA,MAAI,CAACtC,mBAAL,CAAyB,SAAzB,EAAoC3D,UAAU,CAACkG,oBAA/C;;AACAC,oBAAAA,UAAU,CAAC,MAAM;AACf;AACAC,sBAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCZ,YAAY,CAAChD,IAAb,CAAkB6D,SAApD,EAFe,CAGf;;AACA,sBAAA,MAAI,CAAClG,KAAL,CAAWmG,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB;AACD,qBALS,EAKP,IALO,CAAV;AAMD;;AACD,sBAAIV,gBAAgB,KAAK,MAAI,CAACtF,eAA1B,IAA6CiF,YAAY,KAAKQ,SAAlE,EAA6E;AAC3E,oBAAA,MAAI,CAACtC,mBAAL,CAAyB,SAAzB,EAAoC3D,UAAU,CAACkG,oBAA/C;;AACAC,oBAAAA,UAAU,CAAC,MAAM;AAChBC,sBAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8B,MAAI,CAACrC,KAAL,CAAWlC,KAAzC;AACCsE,sBAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCZ,YAAY,CAAChD,IAAb,CAAkB6D,SAApD,EAFe,CAGf;;AACA,sBAAA,MAAI,CAAClG,KAAL,CAAWmG,OAAX,CAAmBC,IAAnB,CAAwB,cAAxB;AACD,qBALS,EAKP,IALO,CAAV;AAMD;AACF;AACF,eAvBD,MAuBO;AACCR,gBAAAA,MADD,GACUP,YAAY,CAACO,MADvB;;AAEL,gBAAA,MAAI,CAACS,0BAAL,CAAgCb,YAAhC;;AACA,oBAAGI,MAAM,CAAC,CAAD,CAAN,CAAUU,KAAV,KAAoB,eAApB,IAAsCV,MAAM,CAAC,CAAD,CAAN,CAAUU,KAAV,KAAqB,mBAA9D,EAAmF;AACjFN,kBAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6B,EAA7B,EADiF,CAEjF;;AACA,kCAAA,MAAI,CAACjG,KAAL,8DAAYmG,OAAZ,CAAoBC,IAApB,CAAyB,QAAzB;AACD,iBAJD,MAIO,IAAGR,MAAM,CAAC,CAAD,CAAN,CAAUpC,OAAb,EAAsB;AAC3B,kBAAA,MAAI,CAACD,mBAAL,CAAyB,OAAzB,EAAkCqC,MAAM,CAAC,CAAD,CAAN,CAAUpC,OAA5C;AACD,iBAFM,MAEC,IAAGoC,MAAM,CAAC,CAAD,CAAN,CAAUW,GAAb,EAAkB;AACxB,kBAAA,MAAI,CAAChD,mBAAL,CAAyB,OAAzB,EAAkCqC,MAAM,CAAC,CAAD,CAAN,CAAUW,GAA5C;AACD;AACF;AACF,aAjD2C,CAkD5C;;;AAlD4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAoD3C,GArKH,CAsKE;;;AAEFC,EAAAA,oBAAoB,GAAG;AACrB,UAAMhG,GAAY,GAAG,IAAInB,OAAJ,CAAYG,OAAO,CAACD,WAAW,CAACkH,mBAAb,CAAnB,CAArB;AACA,SAAK/F,IAAL,CAAUF,GAAV;AACD,GA3KD,CA6KF;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;AAEEkG,EAAAA,oBAAoB,CAACrB,YAAD,EAAoB;AACtC1E,IAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAAuCyE,YAAvC;;AACA,QAAIA,YAAY,IAAIA,YAAY,CAACsB,IAA7B,IAAqCtB,YAAY,CAACsB,IAAb,CAAkBL,KAA3D,EAAkE;AAChE,YAAM9F,GAAY,GAAG,IAAInB,OAAJ,CAAYG,OAAO,CAACD,WAAW,CAACqH,kBAAb,CAAnB,CAArB;AAEApG,MAAAA,GAAG,CAACoC,OAAJ,CACEpD,OAAO,CAACD,WAAW,CAACsH,mBAAb,CADT,EAEE7D,IAAI,CAACC,SAAL,CAAeoC,YAAf,CAFF;AAIA7E,MAAAA,GAAG,CAACoC,OAAJ,CACEpD,OAAO,CAACD,WAAW,CAACuH,oBAAb,CADT,EAEEzB,YAAY,CAACsB,IAAb,CAAkBL,KAFpB;AAICN,MAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA4BZ,YAAY,CAACsB,IAAb,CAAkBL,KAA9C;AAED,WAAK5F,IAAL,CAAUF,GAAV;AAGD;AACF;;AAEDuG,EAAAA,YAAY,GAAG;AACb;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA,SAAK/G,KAAL,CAAWmG,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB,EAZa,CAab;AACD;;AAEDY,EAAAA,kBAAkB,GAAG;AACnB,UAAMxG,GAAY,GAAG,IAAInB,OAAJ,CACnBG,OAAO,CAACD,WAAW,CAAC0H,+BAAb,CADY,CAArB;AAGAzG,IAAAA,GAAG,CAACoC,OAAJ,CAAYpD,OAAO,CAACD,WAAW,CAAC2H,sBAAb,CAAnB,EAAyD,KAAKlH,KAA9D;AACAQ,IAAAA,GAAG,CAACoC,OAAJ,CAAYpD,OAAO,CAACD,WAAW,CAAC4H,gCAAb,CAAnB,EAAmE,OAAnE;AACA,SAAKzG,IAAL,CAAUF,GAAV;AACD;;AAED4G,EAAAA,eAAe,GAAG;AAChB,UAAM5G,GAAY,GAAG,IAAInB,OAAJ,CACnBG,OAAO,CAACD,WAAW,CAAC8H,4BAAb,CADY,CAArB;AAGA7G,IAAAA,GAAG,CAACoC,OAAJ,CAAYpD,OAAO,CAACD,WAAW,CAAC2H,sBAAb,CAAnB,EAAyD,KAAKlH,KAA9D;AACA,SAAKU,IAAL,CAAUF,GAAV;AACD;;AAED8G,EAAAA,iBAAiB,GAAY;AAC3B;AACA;AAEA,QAAI5H,OAAO,CAAC,KAAKkE,KAAL,CAAW1C,QAAZ,CAAX,EAAkC;AAC/B,WAAKF,QAAL,CAAc;AACXC,QAAAA,aAAa,EAACrB,UAAU,CAAC2H;AADd,OAAd;AAGD,aAAO,KAAP;AACD,KALD,MAKM,IAAG,KAAK3D,KAAL,CAAW1C,QAAX,CAAoBsG,MAApB,GAA2B,EAA9B,EAAiC;AACnC,WAAKxG,QAAL,CAAc;AACNC,QAAAA,aAAa,EAACrB,UAAU,CAAC6H;AADnB,OAAd;AAGF,aAAO,KAAP;AACD,KALK,MAKA,IAAI,KAAK7D,KAAL,CAAW1C,QAAX,CAAoBsG,MAApB,GAA6B,CAAjC,EAAmC;AACrC,WAAKxG,QAAL,CAAc;AACNC,QAAAA,aAAa,EAACrB,UAAU,CAAC8H;AADnB,OAAd;AAGF,aAAO,KAAP;AACD;;AAEA,QAAIhI,OAAO,CAAC,KAAKkE,KAAL,CAAWrC,eAAZ,CAAX,EAAyC;AACvC,WAAKP,QAAL,CAAc;AACTM,QAAAA,oBAAoB,EAAC1B,UAAU,CAAC2H;AADvB,OAAd;AAGD,aAAO,KAAP;AACD,KALA,MAKK,IAAI,KAAK3D,KAAL,CAAW1C,QAAX,KAAwB,KAAK0C,KAAL,CAAWrC,eAAvC,EAAuD;AACzD,WAAKP,QAAL,CAAc;AACVM,QAAAA,oBAAoB,EAAC1B,UAAU,CAAC+H;AADtB,OAAd;AAGF,aAAO,KAAP;AACD;;AAED,UAAMzF,MAAM,GAAG;AACb,sBAAgBtC,UAAU,CAACuC;AADd,KAAf;AAIAxB,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyB,KAAKgD,KAA9B;AACA,UAAMxB,KAAK,GAAG;AACZlB,MAAAA,QAAQ,EAAE,KAAK0C,KAAL,CAAW1C,QADT;AAEZ0G,MAAAA,gBAAgB,EAAE,KAAKhE,KAAL,CAAWrC,eAFjB;AAGZG,MAAAA,KAAK,EAAE,KAAKkC,KAAL,CAAWlC,KAAX,IAAoBsE,YAAY,CAAC6B,OAAb,CAAqB,OAArB,CAApB,IAAqD;AAHhD,KAAd;AAMA,UAAMxF,IAAI,GAAG;AACXC,MAAAA,IAAI,EAAE,eADK;AAEXC,MAAAA,UAAU,EAAEH;AAFD,KAAb;AAKA,UAAMI,QAAQ,GAAG;AACfH,MAAAA,IAAI,EAAEA;AADS,KAAjB;AAIA1B,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuB4B,QAAvB;AAEA,UAAMC,cAAc,GAAG,IAAIpD,OAAJ,CACrBG,OAAO,CAACD,WAAW,CAACmD,qBAAb,CADc,CAAvB,CAvD2B,CA2D3B;;AACA,SAAKvC,iBAAL,GAAyBsC,cAAc,CAACE,SAAxC;AACAF,IAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAACsD,8BAAb,CADT,EAEEjD,UAAU,CAACkI,sBAFb;AAKArF,IAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAACwD,2BAAb,CADT,EAEEC,IAAI,CAACC,SAAL,CAAef,MAAf,CAFF;AAKAO,IAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAAC2D,yBAAb,CADT,EAEEF,IAAI,CAACC,SAAL,CAAeT,QAAf,CAFF;AAKAC,IAAAA,cAAc,CAACG,OAAf,CACEpD,OAAO,CAACD,WAAW,CAAC4D,2BAAb,CADT,EAEEvD,UAAU,CAACwD,cAFb;AAMA3D,IAAAA,SAAS,CAAC4D,WAAV,CAAsBZ,cAAc,CAACa,EAArC,EAAyCb,cAAzC;AAEA,WAAO,IAAP;AACD;;AAEDsF,EAAAA,oBAAoB,GAAG;AACrB,UAAMC,OAAO,GAAG;AACd,sBAAgBpI,UAAU,CAACqI;AADb,KAAhB;AAIA,UAAMC,iBAAiB,GAAG,IAAI7I,OAAJ,CACxBG,OAAO,CAACD,WAAW,CAACmD,qBAAb,CADiB,CAA1B;AAGA,SAAKxC,mBAAL,GAA2BgI,iBAAiB,CAACvF,SAA7C;AAEAuF,IAAAA,iBAAiB,CAACtF,OAAlB,CACEpD,OAAO,CAACD,WAAW,CAACsD,8BAAb,CADT,EAEEjD,UAAU,CAACuI,iBAFb;AAKAD,IAAAA,iBAAiB,CAACtF,OAAlB,CACEpD,OAAO,CAACD,WAAW,CAACwD,2BAAb,CADT,EAEEC,IAAI,CAACC,SAAL,CAAe+E,OAAf,CAFF;AAIAE,IAAAA,iBAAiB,CAACtF,OAAlB,CACEpD,OAAO,CAACD,WAAW,CAAC4D,2BAAb,CADT,EAEEvD,UAAU,CAACwI,uBAFb;AAIA3I,IAAAA,SAAS,CAAC4D,WAAV,CAAsB6E,iBAAiB,CAAC5E,EAAxC,EAA4C4E,iBAA5C;AACD;;AAhWD","sourcesContent":["import { IBlock } from \"../../../framework/src/IBlock\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport MessageEnum, {\n  getName,\n} from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\nimport {identity, isEmpty} from 'lodash'\nimport * as Yup from \"yup\";\n\n// Customizable Area Start\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\n\nexport interface Props {\n  navigation: any;\n  id: string;\n  // Customizable Area Start\n  // Customizable Area End\n}\n\ninterface S {\n  // Customizable Area Start\n  email: string;\n  errorEmail: string;\n  password: string;\n  errorPassword: string;\n  confirmPassword: string;\n  errorConfirmPassword: string;\n  EmailOnlySchema: any;\n  NewPasswordSchema: any;\n  snackBar: {\n    show: boolean,\n    message?: string,\n    type?: \"success\" | \"info\" | \"warning\" | \"error\" | undefined\n  };\n  // Customizable Area End\n}\n\ninterface SS {\n  // Customizable Area Start\n  id: any;\n  // Customizable Area End\n}\n\nexport default class EmailAccountLoginController extends BlockComponent<\n  Props,\n  S,\n  SS\n> {\n  // Customizable Area Start\n  apiEmailLoginCallId: string = \"\";\n  validationApiCallId: string = \"\";\n  apiPasswordCallId: string = \"\";\n  apiForgotCallId: string = \"\";\n\n  emailReg: RegExp;\n  labelTitle: string = \"\";\n  // Customizable Area End\n\n  constructor(props: Props) {\n    super(props);\n    this.receive = this.receive.bind(this);\n\n    // Customizable Area Start\n    this.subScribedMessages = [\n      getName(MessageEnum.CountryCodeMessage),\n      getName(MessageEnum.RestAPIResponceMessage),\n      getName(MessageEnum.ReciveUserCredentials),\n    ];\n\n    let EmailOnlySchema ={\n      email: Yup.string()\n        .email(configJSON.errorEmailNotValid)\n        .required(configJSON.errorEmailRequired),\n    }\n\n     let NewPasswordSchema = {\n      password: Yup.string() \n      .matches(\n        configJSON.PASSWORD_REGULAR_EXPRESSION,\n        configJSON.errorNewPasswordNotValid\n        )\n      .required(configJSON.errorNewPasswordEmpty),\n      passwordConfirmation: Yup.string()\n        .oneOf([Yup.ref('password'), null], 'Passwords must match')\n        .required(configJSON.errorNewPasswordEmpty)\n     }\n    \n\n    this.state = {\n      email: '',\n      errorEmail:'',\n      password: \"\",\n      errorPassword: \"\",\n      confirmPassword:'',\n      errorConfirmPassword:'',\n      EmailOnlySchema:EmailOnlySchema,\n      NewPasswordSchema:NewPasswordSchema,\n      snackBar: {\n        show: false,\n      },\n    };\n\n    this.emailReg = new RegExp(\"\");\n    // Customizable Area End\n\n    runEngine.attachBuildingBlock(this as IBlock, this.subScribedMessages);\n  }\n\n  async componentDidMount() {\n    // this.callGetValidationApi();\n    this.send(new Message(getName(MessageEnum.RequestUserCredentials)));\n    // Customizable Area Start\n    \n    // Customizable Area End\n  }\n  getToken = () => {\n    const msg: Message = new Message(\n      getName(MessageEnum.SessionRequestMessage)\n    );\n    this.send(msg);\n   console.log('msg',msg)\n\n  };\n\n  // Customizable Area Start\n  \n  txtInputPasswordWebProps = {\n    onChange: (text: any) => {\n      this.setState({ errorPassword:'' , password: text?.target.value });\n    },\n  };\n\n  txtInputConfirmPasswordWebProps = {\n    onChange: (text: any) => {\n      this.setState({ errorConfirmPassword:'' , confirmPassword: text?.target.value });\n    },\n  };\n\n\n  txtInputEmailWebProps = {\n    onChange: (text: any) => {\n      this.setState({ errorEmail:''  ,email: text?.target.value });\n      //@ts-ignore\n      this.txtInputEmailProps.value = text?.target.value;\n    },\n  };\n\n  txtInputEmailMobileProps = {\n    ...this.txtInputEmailWebProps,\n    autoCompleteType: \"email\",\n    keyboardType: \"email-address\",\n  };\n\n  txtInputEmailProps = this.isPlatformWeb()\n    ? this.txtInputEmailWebProps\n    : this.txtInputEmailMobileProps;\n\n\n\n \n  async receive(from: string, message: Message) {\n     // Customizable Area Start\n   \n    if (getName(MessageEnum.RestAPIResponceMessage) === message.id) {\n      var responseJson = message.getData(\n        getName(MessageEnum.RestAPIResponceSuccessMessage)\n      );\n      var errorReponse = message.getData(\n        getName(MessageEnum.RestAPIResponceErrorMessage)\n      );\n      const apiRequestCallId = message.getData(\n        getName(MessageEnum.RestAPIResponceDataMessage)\n      );\n      if (responseJson && !responseJson.errors) {\n        if (apiRequestCallId != null) {\n         console.log(\"responseJson\",responseJson)\n          // \n          if (apiRequestCallId === this.apiPasswordCallId && responseJson !== undefined) {\n            this.openSnackBarHandler('success', configJSON.successCreateAccount);\n            setTimeout(() => {\n              //@ts-ignore\n              localStorage.setItem(\"user_type\", responseJson.data.user_type);\n              //@ts-ignore\n              this.props.history.push(\"/\");\n            }, 1000);\n          }\n          if (apiRequestCallId === this.apiForgotCallId && responseJson !== undefined) {\n            this.openSnackBarHandler('success', configJSON.successCreateAccount);\n            setTimeout(() => {\n             localStorage.setItem(\"email\", this.state.email);\n              localStorage.setItem(\"user_type\", responseJson.data.user_type);\n              // @ts-ignore\n              this.props.history.push(\"new-password\");\n            }, 1000);\n          }\n        }\n      } else {\n        const errors = responseJson.errors;\n        this.parseApiCatchErrorResponse(errorReponse);\n        if(errors[0].token === 'Invalid token' ||errors[0].token ===  'Token has Expired') {\n          localStorage.setItem(\"auth\", \"\");\n          //@ts-ignore\n          this.props?.history.push(\"/login\");\n        } else if(errors[0].message) {\n          this.openSnackBarHandler('error', errors[0].message);\n        }  else if(errors[0].otp) {\n          this.openSnackBarHandler('error', errors[0].otp);\n        } \n      }\n    }\n    // Customizable Area End\n   \n    }\n    //apiForgotCallId\n\n  sendLoginFailMessage() {\n    const msg: Message = new Message(getName(MessageEnum.LoginFaliureMessage));\n    this.send(msg);\n  }\n\n//   sendLoginSuccessMessage() {\n//     const msg: Message = new Message(getName(MessageEnum.LoginSuccessMessage));\n\n//     msg.addData(getName(MessageEnum.LoginUserName), this.state.email);\n//     msg.addData(getName(MessageEnum.CountyCodeDataMessage), null);\n//     msg.addData(getName(MessageEnum.LoginPassword), this.state.password);\n//     msg.addData(\n//       getName(MessageEnum.LoginIsRememberMe),\n//       this.state.checkedRememberMe\n//     );\n\n//     this.send(msg);\n//   }\n\n  saveLoggedInUserData(responseJson: any) {\n    console.log('responseJsonresponseJson',responseJson)\n    if (responseJson && responseJson.meta && responseJson.meta.token) {\n      const msg: Message = new Message(getName(MessageEnum.SessionSaveMessage));\n\n      msg.addData(\n        getName(MessageEnum.SessionResponseData),\n        JSON.stringify(responseJson)\n      );\n      msg.addData(\n        getName(MessageEnum.SessionResponseToken),\n        responseJson.meta.token\n      );\n       localStorage.setItem('auth',responseJson.meta.token)\n\n      this.send(msg);\n\n      \n    }\n  }\n\n  openInfoPage() {\n    // const msg: Message = new Message(getName(MessageEnum.AccoutLoginSuccess));\n    // console.log('msg',msg)\n    // console.log('this.props',this.props)\n    // msg.addData(getName(MessageEnum.NavigationPropsMessage), this.props);\n\n    // this.send(msg);\n    \n    // localStorage.setItem('auth',);\n    // alert('Login Successful')\n    //@ts-ignore\n\n    this.props.history.push(\"/\");\n    // this.props.history.push(\"select-domain\")\n  }\n\n  goToForgotPassword() {\n    const msg: Message = new Message(\n      getName(MessageEnum.NavigationForgotPasswordMessage)\n    );\n    msg.addData(getName(MessageEnum.NavigationPropsMessage), this.props);\n    msg.addData(getName(MessageEnum.NavigationForgotPasswordPageInfo), \"email\");\n    this.send(msg);\n  }\n\n  goToSocialLogin() {\n    const msg: Message = new Message(\n      getName(MessageEnum.NavigationSocialLogInMessage)\n    );\n    msg.addData(getName(MessageEnum.NavigationPropsMessage), this.props);\n    this.send(msg);\n  }\n\n  createNewPassword(): Boolean {\n    // console.log(\"API HIT\");\n    // console.log('this.state',this.state)\n    \n    if (isEmpty(this.state.password)) {\n       this.setState({\n          errorPassword:configJSON.errorPasswordEmpty\n      })\n      return false;\n    }else if(this.state.password.length>10){\n        this.setState({\n                errorPassword:configJSON.errorPasswordLengthMax\n            })\n      return false;\n    }else if (this.state.password.length < 8){\n        this.setState({\n                errorPassword:configJSON.errorPasswordLengthLess\n            })\n      return false;\n    }\n\n     if (isEmpty(this.state.confirmPassword)) {\n       this.setState({\n            errorConfirmPassword:configJSON.errorPasswordEmpty\n      })\n      return false;\n    }else if( this.state.password !== this.state.confirmPassword){\n        this.setState({\n            errorConfirmPassword:configJSON.errorConfirmPasswordNotMatch\n      })\n      return false;\n    }\n\n    const header = {\n      \"Content-Type\": configJSON.forgotPasswordAPiContentType,\n    };\n\n    console.log('this.state',this.state)\n    const attrs = {\n      password: this.state.password,\n      confirm_password: this.state.confirmPassword,\n      email: this.state.email || localStorage.getItem('email') || '',\n    };\n\n    const data = {\n      type: \"email_account\",\n      attributes: attrs,\n    };\n\n    const httpBody = {\n      data: data,\n    };\n\n    console.log('httpBody',httpBody)\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage) \n    );\n\n    // console.log(\"requestMessage\", requestMessage);\n    this.apiPasswordCallId = requestMessage.messageId;\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.newPasswordApiEndPoint\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(header)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestBodyMessage),\n      JSON.stringify(httpBody)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.httpPostMethod\n    );\n\n   \n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n    return true;\n  }\n\n  callGetValidationApi() {\n    const headers = {\n      \"Content-Type\": configJSON.validationApiContentType,\n    };\n\n    const getValidationsMsg = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n    this.validationApiCallId = getValidationsMsg.messageId;\n\n    getValidationsMsg.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.urlGetValidations\n    );\n\n    getValidationsMsg.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(headers)\n    );\n    getValidationsMsg.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.validationApiMethodType\n    );\n    runEngine.sendMessage(getValidationsMsg.id, getValidationsMsg);\n  }\n\n\n  handleForgotPassword= (values:any) : Boolean =>{\n      // if (\n      //   this.state.email === null ||\n      //   this.state.email.length === 0 ||\n      //   !this.emailReg.test(this.state.email)\n      // ) {\n      //   this.setState({\n      //       errorEmail :configJSON.pleaseEnterAValidEmail\n      //   })  \n      //   return false;\n      // }\n\n    const header = {\n      \"Content-Type\": configJSON.forgotPasswordAPiContentType,\n    };\n\n    // console.log('this.state',this.state)\n    const attrs = {\n      email: values.email\n    };\n\n    const data = {\n      type: \"email_account\",\n      attributes: attrs,\n    };\n\n    const httpBody = {\n      data: data,\n    };\n\n    console.log('httpBody',httpBody)\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage) \n    );\n\n    // console.log(\"requestMessage\", requestMessage);\n    this.apiForgotCallId = requestMessage.messageId;\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.ForgotPasswordApiEndPoint\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(header)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestBodyMessage),\n      JSON.stringify(httpBody)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.httpPostMethod\n    );\n\n   \n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n      return true;\n  }\n\n   // Open View Details Modal\n  openSnackBarHandler = (type: \"success\" | \"info\" | \"warning\" | \"error\" | undefined,  message: string): void => {\n    console.log(\"type,message\",type,message)\n    this.setState({ snackBar: {\n      show: true,\n      message: message,\n      type\n    } });\n  };\n\n  // Close View Details Modal\n  closeSnackBarHandler = () => {\n    this.setState({ snackBar: {\n      show: false,\n      message: this.state.snackBar.message,\n      type: this.state.snackBar.type\n    }});\n  };\n}\n\n"]},"metadata":{},"sourceType":"module"}