{"ast":null,"code":"import _regeneratorRuntime from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport AsyncStorage from \"react-native-web/dist/exports/AsyncStorage\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport MessageEnum, { getName } from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\"; // Customizable Area Start\n// import { imgPasswordInVisible, imgPasswordVisible } from \"./assets\";\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\nexport default class AuditTrailControllerWeb extends BlockComponent {\n  constructor(props) {\n    super(props);\n    this.auth = window.localStorage.getItem(\"auth\");\n    this.getAllMembersApiCallId = \"\";\n    this.getAllLogsApiCallId = \"\";\n    this.trailsOfTeamMemberApiCallId = \"\";\n\n    this.getMembersList = () => {\n      const headers = {\n        \"Content-Type\": configJSON.getAllMembersApiContentType,\n        token: this.auth\n      };\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      this.getAllMembersApiCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.getAllMembersApiEndPoint);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.getAllMembersApiMethodType);\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n      return true;\n    };\n\n    this.getAllLogs = () => {\n      const headers = {\n        \"Content-Type\": configJSON.getAllMembersApiContentType,\n        token: this.auth\n      };\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      this.getAllLogsApiCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.getAllMembersApiEndPoint + \"?all=true\");\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.getAllMembersApiMethodType);\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n      return true;\n    };\n\n    this.trailsOfTeamMember = accountId => {\n      const headers = {\n        \"Content-Type\": configJSON.getAllMembersApiContentType,\n        token: this.auth\n      };\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      this.trailsOfTeamMemberApiCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), \"\".concat(configJSON.getAllMembersApiEndPoint, \"?account_id=\").concat(accountId));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.getAllMembersApiMethodType);\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n      return true;\n    };\n\n    this.handleTrailType = type => {\n      this.setState({\n        trailType: type\n      });\n    };\n\n    this.hanldeOnChangeDate = dates => {\n      const _dates = _slicedToArray(dates, 2),\n            start = _dates[0],\n            end = _dates[1];\n\n      this.setState({\n        startDate: start,\n        endDate: end,\n        showFilterCalendar: end === null || end === \"\"\n      });\n    };\n\n    this.onCalendarClose = () => {\n      this.setState({\n        showFilterCalendar: false\n      });\n    };\n\n    this.onCalendarOpen = () => {\n      this.setState({\n        showFilterCalendar: true\n      });\n    };\n\n    this.onMenuToggle = () => {\n      this.setState({\n        menuCollapsed: !this.state.menuCollapsed\n      });\n    };\n\n    this.openTrailViewDetailsModalHandler = accountId => {\n      this.trailsOfTeamMember(accountId);\n      this.setState({\n        memberDetailsModal: true\n      });\n    };\n\n    this.closeTrailViewDetailsModalHandler = () => {\n      this.setState({\n        memberDetailsModal: false\n      });\n    };\n\n    this.logsFilterHandler = () => {\n      this.setState({\n        showLogsFilter: !this.state.showLogsFilter\n      });\n    };\n\n    this.handleEventTypeChange = selectedOption => {\n      this.setState({\n        selectedEventTypeOption: selectedOption\n      });\n    };\n\n    this.handleResourceTypeChange = selectedOption => {\n      this.setState({\n        selectedResourceTypeOption: selectedOption\n      });\n    };\n\n    this.receive = this.receive.bind(this); // Customizable Area Start\n\n    this.subScribedMessages = [getName(MessageEnum.RestAPIResponceMessage)];\n    this.state = {\n      auth: \"\",\n      trailType: configJSON.membersText,\n      startDate: new Date(),\n      endDate: null,\n      showFilterCalendar: false,\n      userType: configJSON.subscriber,\n      menuCollapsed: false,\n      membersData: [],\n      allLogsData: [],\n      trailsOfTeamMemberData: [],\n      memberDetailsModal: false,\n      showLogsFilter: false,\n      selectedEventTypeOption: null,\n      selectedResourceTypeOption: null,\n      searchText: \"\"\n    }; // Customizable Area End\n\n    runEngine.attachBuildingBlock(this, this.subScribedMessages);\n  }\n\n  componentDidMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _this.getMembersList();\n\n            _this.getAllLogs();\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  } // searchTextInputProps = (e: Event): void => {\n  //   console.log(e?.target?.value);\n  //   // this.setState({ searchText: e.target.value });\n  // };\n  // Handler for Get Members List\n\n\n  receive(from, message) {\n    var _this2 = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var responseJson, errorReponse, apiRequestCallId, _this2$props;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            // Customizable Area Start\n            runEngine.debugLog(\"Message Recevied\", message);\n\n            if (getName(MessageEnum.RestAPIResponceMessage) === message.id) {\n              responseJson = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n              errorReponse = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n\n              if (responseJson && !responseJson.errors && responseJson.data) {\n                apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n\n                if (apiRequestCallId != null) {\n                  // Store All Members data\n                  if (apiRequestCallId === _this2.getAllMembersApiCallId && responseJson !== undefined) {\n                    _this2.setState({\n                      membersData: responseJson.data\n                    });\n                  } // Store All Logs data\n\n\n                  if (apiRequestCallId === _this2.getAllLogsApiCallId && responseJson !== undefined) {\n                    _this2.setState({\n                      allLogsData: responseJson.data\n                    });\n                  } // Store trails Of Team Member detaills\n\n\n                  if (apiRequestCallId === _this2.trailsOfTeamMemberApiCallId && responseJson !== undefined) {\n                    _this2.setState({\n                      trailsOfTeamMemberData: {\n                        data: responseJson.data,\n                        count: responseJson.meta.total_record,\n                        name: responseJson.data[0].attributes.account_detail.name\n                      }\n                    });\n                  }\n                }\n              } else {\n                _this2.parseApiCatchErrorResponse(errorReponse);\n\n                AsyncStorage.setItem(\"auth\", \"\"); //@ts-ignore\n\n                (_this2$props = _this2.props) === null || _this2$props === void 0 ? void 0 : _this2$props.history.push(\"login\");\n              }\n            } // Customizable Area End\n\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }))();\n  } // Trail Type useImperativeHandle(\n  // Customizable Area End\n\n\n}","map":{"version":3,"sources":["/home/lp-greenapex/gargi/okydpim-36944-react-native/src/packages/blocks/AuditTrail/src/AuditTrailController.web.tsx"],"names":["Message","BlockComponent","MessageEnum","getName","runEngine","configJSON","require","AuditTrailControllerWeb","constructor","props","auth","window","localStorage","getItem","getAllMembersApiCallId","getAllLogsApiCallId","trailsOfTeamMemberApiCallId","getMembersList","headers","getAllMembersApiContentType","token","requestMessage","RestAPIRequestMessage","messageId","addData","RestAPIResponceEndPointMessage","getAllMembersApiEndPoint","RestAPIRequestHeaderMessage","JSON","stringify","RestAPIRequestMethodMessage","getAllMembersApiMethodType","sendMessage","id","getAllLogs","trailsOfTeamMember","accountId","handleTrailType","type","setState","trailType","hanldeOnChangeDate","dates","start","end","startDate","endDate","showFilterCalendar","onCalendarClose","onCalendarOpen","onMenuToggle","menuCollapsed","state","openTrailViewDetailsModalHandler","memberDetailsModal","closeTrailViewDetailsModalHandler","logsFilterHandler","showLogsFilter","handleEventTypeChange","selectedOption","selectedEventTypeOption","handleResourceTypeChange","selectedResourceTypeOption","receive","bind","subScribedMessages","RestAPIResponceMessage","membersText","Date","userType","subscriber","membersData","allLogsData","trailsOfTeamMemberData","searchText","attachBuildingBlock","componentDidMount","from","message","debugLog","responseJson","getData","RestAPIResponceSuccessMessage","errorReponse","RestAPIResponceErrorMessage","errors","data","apiRequestCallId","RestAPIResponceDataMessage","undefined","count","meta","total_record","name","attributes","account_detail","parseApiCatchErrorResponse","AsyncStorage","setItem","history","push"],"mappings":"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","sourcesContent":["import { AsyncStorage } from \"react-native\";\nimport { IBlock } from \"../../../framework/src/IBlock\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport MessageEnum, {\n  getName,\n} from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\n\n// Customizable Area Start\n// import { imgPasswordInVisible, imgPasswordVisible } from \"./assets\";\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\n\ninterface SelectOptions {\n  value: string;\n  label: string;\n}\nexport interface Props {\n  navigation: any;\n  id: string;\n  // Customizable Area Start\n  memberDetails: any;\n  // Customizable Area End\n}\n\ninterface S {\n  // Customizable Area Start\n  auth: string | null | undefined;\n  trailType: string;\n  startDate: Date | null | undefined;\n  endDate: Date | null | undefined;\n  showFilterCalendar: boolean;\n  userType: string;\n  menuCollapsed: boolean;\n  membersData: object[];\n  allLogsData: object[];\n  trailsOfTeamMemberData: any;\n  memberDetailsModal: boolean;\n  showLogsFilter: boolean;\n  selectedEventTypeOption: SelectOptions | null;\n  selectedResourceTypeOption: SelectOptions | null;\n  searchText: string | null | undefined;\n  // Customizable Area End\n}\n\ninterface SS {\n  id: any;\n}\n\nexport default class AuditTrailControllerWeb extends BlockComponent<\n  Props,\n  S,\n  SS\n> {\n  auth: string | null | undefined = window.localStorage.getItem(\"auth\");\n  getAllMembersApiCallId: string = \"\";\n  getAllLogsApiCallId: string = \"\";\n  trailsOfTeamMemberApiCallId: string = \"\";\n\n  constructor(props: Props) {\n    super(props);\n    this.receive = this.receive.bind(this);\n\n    // Customizable Area Start\n    this.subScribedMessages = [getName(MessageEnum.RestAPIResponceMessage)];\n\n    this.state = {\n      auth: \"\",\n      trailType: configJSON.membersText,\n      startDate: new Date(),\n      endDate: null,\n      showFilterCalendar: false,\n      userType: configJSON.subscriber,\n      menuCollapsed: false,\n      membersData: [],\n      allLogsData: [],\n      trailsOfTeamMemberData: [],\n      memberDetailsModal: false,\n      showLogsFilter: false,\n      selectedEventTypeOption: null,\n      selectedResourceTypeOption: null,\n      searchText: \"\",\n    };\n    // Customizable Area End\n    runEngine.attachBuildingBlock(this as IBlock, this.subScribedMessages);\n  }\n\n  async componentDidMount() {\n    this.getMembersList();\n    this.getAllLogs();\n  }\n\n  // searchTextInputProps = (e: Event): void => {\n  //   console.log(e?.target?.value);\n  //   // this.setState({ searchText: e.target.value });\n  // };\n\n  // Handler for Get Members List\n  getMembersList = (): boolean => {\n    const headers = {\n      \"Content-Type\": configJSON.getAllMembersApiContentType,\n      token: this.auth,\n    };\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n\n    this.getAllMembersApiCallId = requestMessage.messageId;\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.getAllMembersApiEndPoint\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(headers)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.getAllMembersApiMethodType\n    );\n\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n    return true;\n  };\n\n  // Handler for Get All Logs\n  getAllLogs = (): boolean => {\n    const headers = {\n      \"Content-Type\": configJSON.getAllMembersApiContentType,\n      token: this.auth,\n    };\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n\n    this.getAllLogsApiCallId = requestMessage.messageId;\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.getAllMembersApiEndPoint + \"?all=true\"\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(headers)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.getAllMembersApiMethodType\n    );\n\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n    return true;\n  };\n\n  // Handler for Trails of Team member\n  trailsOfTeamMember = (accountId: number): boolean => {\n    const headers = {\n      \"Content-Type\": configJSON.getAllMembersApiContentType,\n      token: this.auth,\n    };\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n\n    this.trailsOfTeamMemberApiCallId = requestMessage.messageId;\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      `${configJSON.getAllMembersApiEndPoint}?account_id=${accountId}`\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(headers)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.getAllMembersApiMethodType\n    );\n\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n    return true;\n  };\n\n  async receive(from: string, message: Message) {\n    // Customizable Area Start\n    runEngine.debugLog(\"Message Recevied\", message);\n\n    if (getName(MessageEnum.RestAPIResponceMessage) === message.id) {\n      var responseJson = message.getData(\n        getName(MessageEnum.RestAPIResponceSuccessMessage)\n      );\n      var errorReponse = message.getData(\n        getName(MessageEnum.RestAPIResponceErrorMessage)\n      );\n      if (responseJson && !responseJson.errors && responseJson.data) {\n        const apiRequestCallId = message.getData(\n          getName(MessageEnum.RestAPIResponceDataMessage)\n        );\n        if (apiRequestCallId != null) {\n          // Store All Members data\n          if (\n            apiRequestCallId === this.getAllMembersApiCallId &&\n            responseJson !== undefined\n          ) {\n            this.setState({ membersData: responseJson.data });\n          }\n\n          // Store All Logs data\n          if (\n            apiRequestCallId === this.getAllLogsApiCallId &&\n            responseJson !== undefined\n          ) {\n            this.setState({ allLogsData: responseJson.data });\n          }\n\n          // Store trails Of Team Member detaills\n          if (\n            apiRequestCallId === this.trailsOfTeamMemberApiCallId &&\n            responseJson !== undefined\n          ) {\n            this.setState({\n              trailsOfTeamMemberData: {\n                data: responseJson.data,\n                count: responseJson.meta.total_record,\n                name: responseJson.data[0].attributes.account_detail.name,\n              },\n            });\n          }\n        }\n      } else {\n        this.parseApiCatchErrorResponse(errorReponse);\n        AsyncStorage.setItem(\"auth\", \"\");\n        //@ts-ignore\n        this.props?.history.push(\"login\");\n      }\n    }\n    // Customizable Area End\n  }\n\n  // Trail Type useImperativeHandle(\n  handleTrailType = (type: string): void => {\n    this.setState({\n      trailType: type,\n    });\n  };\n\n  // On Date Change\n  hanldeOnChangeDate = (dates: any): any => {\n    const [start, end] = dates;\n    this.setState({\n      startDate: start,\n      endDate: end,\n      showFilterCalendar: end === null || end === \"\",\n    });\n  };\n\n  // Close Calendar popper\n  onCalendarClose = () => {\n    this.setState({\n      showFilterCalendar: false,\n    });\n  };\n\n  // Open Calendar popper\n  onCalendarOpen = () => {\n    this.setState({\n      showFilterCalendar: true,\n    });\n  };\n\n  onMenuToggle = () => {\n    this.setState({\n      menuCollapsed: !this.state.menuCollapsed,\n    });\n  };\n\n  // Open View Details Modal\n  openTrailViewDetailsModalHandler = (accountId: number): void => {\n    this.trailsOfTeamMember(accountId);\n    this.setState({ memberDetailsModal: true });\n  };\n\n  // Close View Details Modal\n  closeTrailViewDetailsModalHandler = () => {\n    this.setState({ memberDetailsModal: false });\n  };\n\n  logsFilterHandler = () => {\n    this.setState({ showLogsFilter: !this.state.showLogsFilter });\n  };\n\n  handleEventTypeChange = (selectedOption: any) => {\n    this.setState({ selectedEventTypeOption: selectedOption });\n  };\n\n  handleResourceTypeChange = (selectedOption: any) => {\n    this.setState({ selectedResourceTypeOption: selectedOption });\n  };\n  // Customizable Area End\n}\n"]},"metadata":{},"sourceType":"module"}