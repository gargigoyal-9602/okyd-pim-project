{"ast":null,"code":"import _regeneratorRuntime from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/lp-greenapex/gargi/okydpim-36944-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport MessageEnum, { getName } from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\nimport * as Yup from \"yup\";\n// Customizable Area Start\n// Customizable Area End\nexport const configJSON = require(\"./config\");\nexport default class UserProfileSettingController extends BlockComponent {\n  constructor(props) {\n    super(props);\n    this.userProfileApiCallId = \"\";\n    this.userUpdateProfileApiCallId = \"\";\n    this.userUpdateChangePassword = \"\";\n\n    this.getUserProfileDetails = () => {\n      const headers = {\n        \"Content-Type\": configJSON.contentTypeApiGetUserProfile,\n        token: window.localStorage.getItem(\"auth\")\n      };\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      this.userProfileApiCallId = requestMessage.messageId;\n      console.log(\"this.userProfileApiCallId\", this.userProfileApiCallId);\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.endPointApiGetUserProfileDetails);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.methodTypeApiGetUserProfile);\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n      return true;\n    };\n\n    this.onMenuToggle = () => {\n      this.setState({\n        menuCollapsed: !this.state.menuCollapsed,\n        generalInformation: !this.state.generalInformation\n      });\n    };\n\n    this.handleGeneralInformation = () => {\n      this.setState({\n        generalInformation: !this.state.generalInformation,\n        changePassword: !this.state.changePassword\n      });\n    };\n\n    this.handleChangePassword = () => {\n      this.setState({\n        changePassword: !this.state.changePassword,\n        generalInformation: !this.state.generalInformation\n      });\n    };\n\n    this.handleUpdateProfileDetails = values => {\n      const header = {\n        \"Content-Type\": configJSON.contentTypeApiUpdateUser,\n        token: window.localStorage.getItem(\"auth\")\n      }; //console.log(values);\n\n      const attrs = {\n        \"fullname\": values.fullname,\n        \"designation\": values.designation,\n        \"address\": values.address,\n        \"country\": values.country,\n        \"full_phone_number\": values.full_phone_number\n      };\n      const data = {\n        attributes: attrs\n      };\n      const httpBody = {\n        data: data\n      }; //console.log(\"httpBody\", httpBody);\n\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage)); //console.log(\"requestMessage\", requestMessage);\n\n      this.userUpdateProfileApiCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.endPointApiPutUserProfileUpdatedDetails);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(header));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(httpBody));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.methodTypeApiPostUserProfileUpdated);\n      runEngine.sendMessage(requestMessage.id, requestMessage); //console.log(\"values\", values);\n\n      return true;\n    };\n\n    this.handleUpdateChangePassword = values => {\n      const header = {\n        \"Content-Type\": configJSON.contentTypeApiUpdateUser,\n        token: window.localStorage.getItem(\"auth\")\n      }; // console.log(\"this.state\", this.state);\n\n      const attrs = values;\n      const data = {\n        type: this.state.email,\n        attributes: attrs\n      };\n      const httpBody = {\n        data: data\n      }; //console.log(\"httpBody\", httpBody);\n\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage)); //console.log(\"requestMessage\", requestMessage);\n\n      this.userUpdateChangePassword = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.endPointApiPostUserUpdateChangePassword);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(header));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(httpBody));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.callTypeApiValidateMobileNo);\n      runEngine.sendMessage(requestMessage.id, requestMessage); //console.log(\"values\", values);\n\n      return true;\n    };\n\n    this.receive = this.receive.bind(this); // Customizable Area Start\n\n    this.subScribedMessages = [getName(MessageEnum.AccoutLoginSuccess), getName(MessageEnum.RestAPIResponceMessage)];\n    let ProfileGeneralInformationSchema = {\n      fullname: Yup.string().required(configJSON.errorNameEmpty),\n      designation: Yup.string().required(configJSON.errorDesignationEmpty),\n      full_phone_number: Yup.string().required(configJSON.errorPhoneEmpty).matches(configJSON.PHONE_REGULAR_EXPRESSION, configJSON.errorPhoneNotMatch),\n      email: Yup.string().email(configJSON.errorEmailValidation).required(configJSON.errorEmailEmpty),\n      address: Yup.string().required(configJSON.errorAddressEmpty),\n      companyName: Yup.string().required(configJSON.errorCompanyNameEmpty),\n      country: Yup.string().nullable().required(configJSON.errorCountryEmpty)\n    };\n    let ProfileChangePasswordSchema = {\n      old_password: Yup.string().required(configJSON.errorPassword),\n      new_password: Yup.string().required(configJSON.errorNewPasswordEmpty).matches(configJSON.PASSWORD_REGULAR_EXPRESSION, configJSON.errorNewPasswordNotValid),\n      confirm_new_password: Yup.string().required(configJSON.errorConfirmNewPasswordEmpty).when(\"newPassword\", {\n        is: val => val && val.length > 0 ? true : false,\n        then: Yup.string().oneOf([Yup.ref(\"newPassword\")], configJSON.errorConfirmNewPasswordNotMatch)\n      })\n    };\n    this.state = {\n      user_type: configJSON.subscriber,\n      menuCollapsed: false,\n      searchText: \"\",\n      ProfileGeneralInformationSchema: ProfileGeneralInformationSchema,\n      ProfileChangePasswordSchema: ProfileChangePasswordSchema,\n      fullname: \"\",\n      designation: \"\",\n      full_phone_number: \"\",\n      email: \"\",\n      address: \"\",\n      country: \"\",\n      companyName: \"\",\n      generalInformation: false,\n      changePassword: false,\n      old_password: \"\",\n      new_password: \"\",\n      confirm_new_password: \"\"\n    };\n    runEngine.attachBuildingBlock(this, this.subScribedMessages);\n  } // Customizable Area Start\n\n\n  componentDidMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _this.getUserProfileDetails();\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  }\n\n  receive(from, message) {\n    var _this2 = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var responseJson, apiRequestCallId, errorReponse;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            // Customizable Area Start\n            runEngine.debugLog(\"Message Recived\", message);\n\n            if (getName(MessageEnum.RestAPIResponceMessage) === message.id) {\n              responseJson = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n\n              if (responseJson && !responseJson.errors && responseJson.data) {\n                apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n\n                if (apiRequestCallId != null) {\n                  //console.log(responseJson.data)\n                  if (apiRequestCallId === _this2.userProfileApiCallId) {\n                    console.log(responseJson.data);\n\n                    _this2.setState({\n                      fullname: responseJson.data.attributes.fullname,\n                      email: responseJson.data.attributes.email,\n                      designation: responseJson.data.attributes.designation,\n                      full_phone_number: responseJson.data.attributes.full_phone_number,\n                      address: responseJson.data.attributes.address,\n                      companyName: responseJson.data.attributes.company_name,\n                      country: responseJson.data.attributes.country //  user_type:responseJson.data.attributes.user_type\n\n                    });\n                  }\n\n                  if (apiRequestCallId === _this2.userUpdateProfileApiCallId) {\n                    console.log(responseJson, \"updated response\");\n                  }\n\n                  if (apiRequestCallId === _this2.userUpdateChangePassword) {\n                    console.log(responseJson, \"updated password\");\n                  }\n                }\n              } else {\n                errorReponse = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n\n                _this2.parseApiCatchErrorResponse(errorReponse);\n              }\n            }\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }))();\n  } // Handler Profile Details\n\n\n}","map":{"version":3,"sources":["/home/lp-greenapex/gargi/okydpim-36944-react-native/src/packages/blocks/user-profile-basic/src/UserProfileSettingController.web.tsx"],"names":["Message","BlockComponent","MessageEnum","getName","runEngine","Yup","configJSON","require","UserProfileSettingController","constructor","props","userProfileApiCallId","userUpdateProfileApiCallId","userUpdateChangePassword","getUserProfileDetails","headers","contentTypeApiGetUserProfile","token","window","localStorage","getItem","requestMessage","RestAPIRequestMessage","messageId","console","log","addData","RestAPIResponceEndPointMessage","endPointApiGetUserProfileDetails","RestAPIRequestHeaderMessage","JSON","stringify","RestAPIRequestMethodMessage","methodTypeApiGetUserProfile","sendMessage","id","onMenuToggle","setState","menuCollapsed","state","generalInformation","handleGeneralInformation","changePassword","handleChangePassword","handleUpdateProfileDetails","values","header","contentTypeApiUpdateUser","attrs","fullname","designation","address","country","full_phone_number","data","attributes","httpBody","endPointApiPutUserProfileUpdatedDetails","RestAPIRequestBodyMessage","methodTypeApiPostUserProfileUpdated","handleUpdateChangePassword","type","email","endPointApiPostUserUpdateChangePassword","callTypeApiValidateMobileNo","receive","bind","subScribedMessages","AccoutLoginSuccess","RestAPIResponceMessage","ProfileGeneralInformationSchema","string","required","errorNameEmpty","errorDesignationEmpty","errorPhoneEmpty","matches","PHONE_REGULAR_EXPRESSION","errorPhoneNotMatch","errorEmailValidation","errorEmailEmpty","errorAddressEmpty","companyName","errorCompanyNameEmpty","nullable","errorCountryEmpty","ProfileChangePasswordSchema","old_password","errorPassword","new_password","errorNewPasswordEmpty","PASSWORD_REGULAR_EXPRESSION","errorNewPasswordNotValid","confirm_new_password","errorConfirmNewPasswordEmpty","when","is","val","length","then","oneOf","ref","errorConfirmNewPasswordNotMatch","user_type","subscriber","searchText","attachBuildingBlock","componentDidMount","from","message","debugLog","responseJson","getData","RestAPIResponceSuccessMessage","errors","apiRequestCallId","RestAPIResponceDataMessage","company_name","errorReponse","RestAPIResponceErrorMessage","parseApiCatchErrorResponse"],"mappings":"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","sourcesContent":["import { IBlock } from \"../../../framework/src/IBlock\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport MessageEnum, {\n  getName,\n} from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\nimport * as Yup from \"yup\";\nimport { values } from \"lodash\";\n\n// Customizable Area Start\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\n\nexport interface Props {\n  navigation: any;\n  id: string;\n  // Customizable Area Start\n  memberDetails: any;\n  // Customizable Area End\n}\n\ninterface S {\n  // Customizable Area Start\n  user_type: string;\n  menuCollapsed: boolean;\n  searchText: string | null | undefined;\n  ProfileGeneralInformationSchema: any;\n  ProfileChangePasswordSchema: any;\n  generalInformation: boolean;\n  changePassword: boolean;\n  fullname: string;\n  designation: string;\n  full_phone_number: string;\n  email: string;\n  address: string;\n  country: string;\n  companyName: string;\n  old_password: string;\n  new_password: string;\n  confirm_new_password: string,\n  // Customizable Area End\n}\n\ninterface SelectOptions {\n  value: string;\n  label: string;\n}\n\ninterface SS {\n  id: any;\n}\n\nexport default class UserProfileSettingController extends BlockComponent<Props, S, SS> {\n  userProfileApiCallId: string = \"\";\n  userUpdateProfileApiCallId: string = \"\";\n  userUpdateChangePassword: string = \"\";\n\n  constructor(props: Props) {\n    super(props);\n    this.receive = this.receive.bind(this);\n\n    // Customizable Area Start\n    this.subScribedMessages = [\n      getName(MessageEnum.AccoutLoginSuccess),\n      getName(MessageEnum.RestAPIResponceMessage),\n    ];\n\n    let ProfileGeneralInformationSchema = {\n      fullname: Yup.string().required(configJSON.errorNameEmpty),\n      designation: Yup.string().required(configJSON.errorDesignationEmpty),\n      full_phone_number: Yup.string()\n        .required(configJSON.errorPhoneEmpty)\n        .matches(\n          configJSON.PHONE_REGULAR_EXPRESSION,\n          configJSON.errorPhoneNotMatch\n        ),\n      email: Yup.string()\n        .email(configJSON.errorEmailValidation)\n        .required(configJSON.errorEmailEmpty),\n      address: Yup.string().required(configJSON.errorAddressEmpty),\n      companyName: Yup.string().required(configJSON.errorCompanyNameEmpty),\n      country: Yup.string()\n        .nullable()\n        .required(configJSON.errorCountryEmpty),\n    };\n\n    let ProfileChangePasswordSchema = {\n      old_password: Yup.string().required(configJSON.errorPassword),\n      new_password: Yup.string()\n        .required(configJSON.errorNewPasswordEmpty)\n        .matches(\n          configJSON.PASSWORD_REGULAR_EXPRESSION,\n          configJSON.errorNewPasswordNotValid\n        ),\n      confirm_new_password: Yup.string()\n        .required(configJSON.errorConfirmNewPasswordEmpty)\n        .when(\"newPassword\", {\n          is: (val) => (val && val.length > 0 ? true : false),\n          then: Yup.string().oneOf(\n            [Yup.ref(\"newPassword\")],\n            configJSON.errorConfirmNewPasswordNotMatch\n          ),\n        }),\n    };\n\n    this.state = {\n      user_type: configJSON.subscriber,\n      menuCollapsed: false,\n      searchText: \"\",\n      ProfileGeneralInformationSchema: ProfileGeneralInformationSchema,\n      ProfileChangePasswordSchema: ProfileChangePasswordSchema,\n      fullname: \"\",\n      designation: \"\",\n      full_phone_number: \"\",\n      email: \"\",\n      address: \"\",\n      country: \"\",\n      companyName: \"\",\n      generalInformation: false,\n      changePassword: false,\n      old_password: \"\",\n      new_password: \"\",\n      confirm_new_password: \"\",\n    };\n\n    runEngine.attachBuildingBlock(this as IBlock, this.subScribedMessages);\n  }\n\n  // Customizable Area Start\n\n  async componentDidMount() {\n    this.getUserProfileDetails();\n  }\n\n  async receive(from: string, message: Message) {\n    // Customizable Area Start\n    runEngine.debugLog(\"Message Recived\", message);\n\n    if (getName(MessageEnum.RestAPIResponceMessage) === message.id) {\n      var responseJson = message.getData(\n        getName(MessageEnum.RestAPIResponceSuccessMessage)\n      );\n      if (responseJson && !responseJson.errors && responseJson.data) {\n        const apiRequestCallId = message.getData(\n          getName(MessageEnum.RestAPIResponceDataMessage)\n        );\n        if (apiRequestCallId != null) {\n\n          //console.log(responseJson.data)\n          if (apiRequestCallId === this.userProfileApiCallId) {\n            console.log(responseJson.data)\n            this.setState({\n              fullname: responseJson.data.attributes.fullname,\n              email: responseJson.data.attributes.email,\n              designation: responseJson.data.attributes.designation,\n              full_phone_number: responseJson.data.attributes.full_phone_number,\n              address: responseJson.data.attributes.address,\n              companyName: responseJson.data.attributes.company_name,\n              country: responseJson.data.attributes.country,\n              //  user_type:responseJson.data.attributes.user_type\n\n            });\n          }\n\n          if (apiRequestCallId === this.userUpdateProfileApiCallId) {\n            console.log(responseJson, \"updated response\")\n\n          }\n\n          if (apiRequestCallId === this.userUpdateChangePassword) {\n            console.log(responseJson, \"updated password\")\n\n          }\n\n\n        }\n      } else {\n        var errorReponse = message.getData(\n          getName(MessageEnum.RestAPIResponceErrorMessage)\n        );\n        this.parseApiCatchErrorResponse(errorReponse);\n      }\n    }\n  }\n\n  // Handler Profile Details\n  getUserProfileDetails = (): boolean => {\n    const headers = {\n      \"Content-Type\": configJSON.contentTypeApiGetUserProfile,\n      token: window.localStorage.getItem(\"auth\"),\n    };\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n\n    this.userProfileApiCallId = requestMessage.messageId;\n    console.log(\"this.userProfileApiCallId\", this.userProfileApiCallId);\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.endPointApiGetUserProfileDetails\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(headers)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.methodTypeApiGetUserProfile\n    );\n\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n    return true;\n  };\n\n  onMenuToggle = () => {\n    this.setState({\n      menuCollapsed: !this.state.menuCollapsed,\n      generalInformation: !this.state.generalInformation,\n    });\n  };\n\n\n  handleGeneralInformation = () => {\n    this.setState({\n      generalInformation: !this.state.generalInformation,\n      changePassword: !this.state.changePassword,\n    });\n  };\n\n  handleChangePassword = () => {\n    this.setState({\n      changePassword: !this.state.changePassword,\n      generalInformation: !this.state.generalInformation,\n    });\n  };\n\n  //// handle api for update profile details\n\n  handleUpdateProfileDetails = (values: any): boolean => {\n    const header = {\n      \"Content-Type\": configJSON.contentTypeApiUpdateUser,\n      token: window.localStorage.getItem(\"auth\"),\n    };\n\n\n    //console.log(values);\n\n    const attrs =\n    {\n      \"fullname\": values.fullname,\n      \"designation\": values.designation,\n      \"address\": values.address,\n      \"country\": values.country,\n      \"full_phone_number\": values.full_phone_number\n    }\n\n    const data = {\n      attributes: attrs,\n    };\n\n    const httpBody = {\n      data: data,\n    };\n\n    //console.log(\"httpBody\", httpBody);\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n\n    //console.log(\"requestMessage\", requestMessage);\n    this.userUpdateProfileApiCallId = requestMessage.messageId;\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.endPointApiPutUserProfileUpdatedDetails\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(header)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestBodyMessage),\n      JSON.stringify(httpBody)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.methodTypeApiPostUserProfileUpdated\n    );\n\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n\n    //console.log(\"values\", values);\n    return true;\n  };\n\n  //// handle api for change password\n  handleUpdateChangePassword = (values: any): boolean => {\n    const header = {\n      \"Content-Type\": configJSON.contentTypeApiUpdateUser,\n      token: window.localStorage.getItem(\"auth\"),\n\n    };\n\n    // console.log(\"this.state\", this.state);\n    const attrs = values\n\n    const data = {\n      type: this.state.email,\n      attributes: attrs,\n    };\n\n    const httpBody = {\n      data: data,\n    };\n\n    //console.log(\"httpBody\", httpBody);\n\n    const requestMessage = new Message(\n      getName(MessageEnum.RestAPIRequestMessage)\n    );\n\n    //console.log(\"requestMessage\", requestMessage);\n    this.userUpdateChangePassword = requestMessage.messageId;\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIResponceEndPointMessage),\n      configJSON.endPointApiPostUserUpdateChangePassword\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestHeaderMessage),\n      JSON.stringify(header)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestBodyMessage),\n      JSON.stringify(httpBody)\n    );\n\n    requestMessage.addData(\n      getName(MessageEnum.RestAPIRequestMethodMessage),\n      configJSON.callTypeApiValidateMobileNo\n    );\n\n    runEngine.sendMessage(requestMessage.id, requestMessage);\n    //console.log(\"values\", values);\n\n    return true\n  }\n}\n"]},"metadata":{},"sourceType":"module"}